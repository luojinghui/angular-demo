<!DOCTYPE html>
<html ng-app="app">

<head>
    <meta charset="UTF-8"/>
    <!--<script data-require="angular.js@1.3.0-beta.5" data-semver="1.3.0-beta.5" src="https://code.angularjs.org/1.3.0-beta.5/angular.js"></script>-->
    <script src="../js/angular.js"></script>
</head>
<style>
    .value-line{
        margin-bottom:1px;
        background:green;
        color:white;

    }
</style>
<body>
<h1>冒泡排序算法视觉化</h1>


<div ng-controller="ctrl">
    <div class="value-line" ng-repeat="i in data" style="width:{{i*10}}px;">{{i}}</div>

    <button ng-click="start()">排序</button>
    <button ng-click="reset()">重置</button>
    <span style="color:red">{{alertMsg}}</span>

</div>


</body>
<script>

    var app = angular.module("app", []);
    app.controller('ctrl', function($scope, $timeout) {
        var defaultData=[37,28,29,24,21,11,5,10,4,3,8,1,25,12,20,30];

        $scope.reset=function(){
            $scope.data=defaultData.map(function(i){
                return i;
            });
            pointer=0;
            checklen=$scope.data.length;
            $scope.alertMsg="";

        }

        var sorting=function(){
            var data=$scope.data;


            if(data[pointer]>data[pointer+1])
            {
                var tmp=data[pointer];
                data[pointer]=data[pointer+1];
                data[pointer+1]=tmp;
            }

            pointer++;
            if( pointer>=checklen){
                checklen--;
                pointer=0;
            }

            if(checklen <=0){
                $scope.alertMsg="排序结束";
            }else{
                $timeout(sorting,100);
            }

        };

        $scope.start=function(){
            $timeout(sorting,100);
        };

        $scope.reset();

    });

//    function ctrl($scope,$timeout){
//        var defaultData=[37,28,29,24,21,11,5,10,4,3,8,1,25,12,20,30];
//
//        $scope.reset=function(){
//            $scope.data=defaultData.map(function(i){
//                return i;
//            });
//            pointer=0;
//            checklen=$scope.data.length;
//            $scope.alertMsg="";
//
//        }
//
//
//        var sorting=function(){
//            var data=$scope.data;
//
//
//            if(data[pointer]>data[pointer+1])
//            {
//                var tmp=data[pointer];
//                data[pointer]=data[pointer+1];
//                data[pointer+1]=tmp;
//            }
//
//            pointer++;
//            if( pointer>=checklen){
//                checklen--;
//                pointer=0;
//            }
//
//            if(checklen <=0){
//                $scope.alertMsg="排序结束";
//            }else{
//                $timeout(sorting,100);
//            }
//
//        };
//
//        $scope.start=function(){
//            $timeout(sorting,100);
//
//        }
//
//        $scope.reset();
//
//    }



//    for(var i = 0; i < 10; i++) {
//        (function(e) {
//            setTimeout(function() {
//                console.log(i);
//            }, 1000);
//        })(i);
//    }

//    for(var i = 0; i < 10; i++) {
//        setTimeout((function(e) {
//            return function() {
//                console.log(e);
//            }
//        })(i), 2000)
//    }
//function add(a, b) {
//    return a + b;
//}
//console.log(add(1, 2));
</script>
</html>